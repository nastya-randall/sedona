"use strict";!function(){var currentIndex,currentItem,popup=document.querySelector(".popup"),popupContainer=popup.querySelector(".popup__container"),gallery=document.querySelector(".gallery__list"),next=popup.querySelector(".popup__nav--next"),prev=popup.querySelector(".popup__nav--prev"),galleryItems=gallery.querySelectorAll(".gallery__item"),updateItem=function(index){currentItem=galleryItems[index].cloneNode(!0),popupContainer.appendChild(currentItem),popup.querySelector(".gallery__item").classList.add("popup__gallery-item"),popup.querySelector(".gallery__item-wrapper").classList.add("popup__item-wrapper"),popup.querySelector(".gallery__item-author").classList.add("popup__item-author"),popup.querySelector(".gallery__likes-icon").classList.add("popup__likes-icon");var image=popup.querySelector("img"),item=popup.querySelector("li"),imageName=image.dataset.filename,newImage=document.createElement("img");item.removeChild(item.querySelector("picture")),newImage.src="img/photo-"+imageName,function(index,img){window.matchMedia("(min-width: 1200px)").matches?function(index,img){img.src=0!=index?img.src+"-desktop@2x.jpg":img.src+"-tablet@2x.jpg"}(index,img):window.matchMedia("(min-width: 768px)").matches?img.src=img.src+"-tablet@2x.jpg":img.src=img.src+"-mobile@2x.jpg"}(index,newImage),item.insertBefore(newImage,item.firstChild),newImage.classList.add("popup__item-image"),prev.classList.remove("popup__nav--show"),prev.classList.add("popup__nav--hide"),next.classList.remove("popup__nav--show"),next.classList.add("popup__nav--hide"),function(index){0!=index&&(prev.classList.remove("popup__nav--hide"),prev.classList.add("popup__nav--show")),index!=galleryItems.length-1&&(next.classList.remove("popup__nav--hide"),next.classList.add("popup__nav--show"))}(index)};gallery.addEventListener("click",function(evt){var target=evt.target;"IMG"==target.tagName&&(popup.classList.add("popup--show"),currentIndex=parseInt(target.id,10),updateItem(currentIndex))}),next.addEventListener("click",function(){currentIndex<galleryItems.length-1&&(popupContainer.innerHTML="",updateItem(currentIndex+=1))}),prev.addEventListener("click",function(){0<currentIndex&&(popupContainer.innerHTML="",updateItem(currentIndex-=1))});var closePopup=function(){popupContainer.innerHTML="",popup.classList.remove("popup--show")};popup.querySelector(".popup__overlay").addEventListener("click",closePopup),window.addEventListener("keydown",function(evt){27===evt.keyCode&&(evt.preventDefault(),popup.classList.contains("popup--show")&&closePopup())})}();